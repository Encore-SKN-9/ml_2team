# ML-2Team

# 0. Introduction Team (íŒ€ ì†Œê°œ)

### ğŸ¥íŒ€ëª… : ë¬´ë¹™

- **"movie + bing = mobing"**  ì˜í™”ê³„ì˜ **Bing**(Microsoft Bing Search)
- í”„ë¡œì íŠ¸ ê¸°ê°„: 2025.01.22 ~ 02.03
<table align=center>
  <tbody>
    <tr>
    <br>
      <td align=center><b>ê¹€ì˜ì„œ</b></td>
      <td align=center><b>ìœ ì§€ì€</b></td>
      <td align=center><b>ì „ì„±ì›</b></td>
      <td align=center><b>í—ˆì •ìœ¤</b></td>
    </tr>
    <tr>
      <td align="center">
          <img src="https://github.com/user-attachments/assets/cdc693b5-b048-4f54-a5bd-2b59c13ca869"  width="200px;" alt="ê¹€ì˜ì„œ"/>
      <td align="center">
          <img src="https://github.com/user-attachments/assets/1f1060b9-993e-4bb4-99c7-bfb28a28dc5f" width="200px;" alt="ìœ ì§€ì€"/>
      </td>
      <td align="center">
        <img src="https://github.com/user-attachments/assets/afb0ea10-9ded-4904-872e-e0671aadbeb8" width="200px;" alt="ì „ì„±ì›"/>
      </td>
      <td align="center">
        <img src="https://github.com/user-attachments/assets/1b530781-7ce5-4eeb-b95b-ea973c145739" width="200px;" alt="í—ˆì •ìœ¤"/>
      </td>
    </tr>
    <tr>
      <td><a href="https://github.com/youngseo98"><div align=center>@youngseo98</div></a></td>
      <td><a href="https://github.com/yujitaeng"><div align=center>@yujitaeng</div></a></td>
      <td><a href="https://github.com/Hack012"><div align=center>@Hack012</div></a></td>
      <td><a href="https://github.com/devunis"><div align=center>@devunis</div></a></td>
    </tr>
  </tbody>
</table>

# 1. Introduction Project (í”„ë¡œì íŠ¸ ê°œìš”)

### ğŸ¥í”„ë¡œì íŠ¸ ëª…

**ë¬´ë¹™**: ë°ì´í„° ê¸°ë°˜ ì˜í™” ì œì‘ ì „ëµ ë¶„ì„ ë° í¥í–‰ ì˜ˆì¸¡

### ğŸ¥í”„ë¡œì íŠ¸ ì†Œê°œ

ìµœê·¼ 20ë…„ê°„ì˜ ì˜í™” ë°ì´í„°ë¥¼ ì¢…í•©ì ìœ¼ë¡œ ë¶„ì„í•˜ì—¬ ì˜í™” ì‹œì¥ì˜ íŠ¸ë Œë“œì™€ ì„±ê³µ ìš”ì¸ì„ ë„ì¶œí•˜ê³ , ì´ë¥¼ í†µí•´ ì˜í™” ì œì‘ì‚¬ë“¤ì´ íš¨ê³¼ì ì¸ ì˜ì‚¬ê²°ì •ì„ í•  ìˆ˜ ìˆë„ë¡ ì§€ì›í•˜ëŠ” ë°ì´í„° ë¶„ì„ ë° AI ì˜ˆì¸¡ í”„ë¡œì íŠ¸ì…ë‹ˆë‹¤. ë§ˆì¼€íŒ…, ë°ì´í„° ë¶„ì„, í™ë³´, ìŠ¤í† ë¦¬ ê°œë°œ ë“± ì˜í™” ì œì‘ì˜ í•µì‹¬ ë¶„ì•¼ë³„ ì¸ì‚¬ì´íŠ¸ë¥¼ ì œê³µí•˜ê³  í¥í–‰ ì„±ì ì„ ì˜ˆì¸¡í•˜ì—¬ ì‹¤ì§ˆì ì¸ ë¹„ì¦ˆë‹ˆìŠ¤ ê°€ì¹˜ë¥¼ ì°½ì¶œí•˜ê³ ì í•©ë‹ˆë‹¤.

### ğŸ¥í”„ë¡œì íŠ¸ í•„ìš”ì„±(ë°°ê²½)

- ë°°ê²½:
    - ì˜í™” ì‚°ì—…ì˜ íˆ¬ì ë¦¬ìŠ¤í¬ ì¦ê°€ì™€ ê´€ê° ì·¨í–¥ì˜ ë‹¤ë³€í™”
    - ë°ì´í„° ê¸°ë°˜ ì˜ì‚¬ê²°ì •ì˜ ì¤‘ìš”ì„± ì¦ëŒ€
    - ì œì‘ë¹„ ìƒìŠ¹ìœ¼ë¡œ ì¸í•œ ROI ê´€ë¦¬ì˜ í•„ìš”ì„±
- ëª©í‘œ:
    - ê°ê´€ì  ë°ì´í„° ë¶„ì„ì„ í†µí•œ ì˜í™” ì‹œì¥ íŠ¸ë Œë“œ íŒŒì•…
    - ì¥ë¥´ë³„, ì˜ˆì‚°ë³„ ROI ë¶„ì„ì„ í†µí•œ ìµœì  íˆ¬ì ì „ëµ ë„ì¶œ
    - ê´€ê° ì„ í˜¸ë„ ë¶„ì„ì„ í†µí•œ ì„±ê³µì ì¸ ì½˜í…ì¸  ê¸°íš ê°€ì´ë“œë¼ì¸ ì œì‹œ
- í”„ë¡œì íŠ¸ì— ì‚¬ìš©ëœ ë°ì´í„° ì¶œì²˜:
    - ì¶œì²˜: IMDB Movies Dataset (1960-2023)
    - ë§í¬:  https://www.kaggle.com/datasets/raedaddala/imdb-movies-from-1960-to-2023
    - ë¶„ì„ ë²”ìœ„: 2005-2024ë…„ (ìµœê·¼ 20ë…„) ë°ì´í„°
    - ì£¼ìš” ë¶„ì„ í•­ëª©:
        - ì¥ë¥´ë³„ í¥í–‰ ì¶”ì´
        - ì˜ˆì‚° ëŒ€ë¹„ ìˆ˜ìµë¥ 
        - ê´€ê° í‰ì ê³¼ í¥í–‰ì˜ ìƒê´€ê´€ê³„

# 2. Data Pre-Processing (ë°ì´í„° ì „ì²˜ë¦¬)

>EDAì—ì„œ ì „ì²˜ë¦¬ë¥¼ ì§„í–‰í•œ ë°ì´í„° ì‚¬ìš© ([eda_2team](https://github.com/Encore-SKN-9/eda_2team?tab=readme-ov-file#2-data-pre-processing))
### ì‚­ì œí•˜ê±°ë‚˜ ì‚¬ìš©í•˜ì§€ ì•Šì€ Feature List
  - êµ­ê°€, ì´¬ì˜ì§€, ì–¸ì–´, ìˆ˜ìƒ ì •ë³´, í‰ì  ì •ë³´, ë¶ë¯¸/ì£¼ë§ ìˆ˜ìµ Feature ì‚­ì œ
  - genres Featureì˜ ê²½ìš° Category Featureë¡œ ëŒ€ì²´
  - ì˜í™” ë“±ê¸‰, ê°œë´‰ë…„ë„, ìƒì˜ì‹œê°„ Feature ì‚­ì œ
### í•™ìŠµí•œ Feature List
  - **budget** (ì˜ˆì‚°)
  - **directors** (ê°ë…)
  - **writers** (ì‘ê°€)
  - **stars** (ë°°ìš°)
  - **production_companies** (ì œì‘ì‚¬)
  - **Category** (ì¹´í…Œê³ ë¦¬ (í° ì¥ë¥´))
### Encoding
  - ê°ë…, ì‘ê°€, ë°°ìš°, ì œì‘ì‚¬ì˜ ê²½ìš° ì½¤ë§ˆë¥¼ êµ¬ë¶„ìœ¼ë¡œ ë°ì´í„°ê°€ ì¡´ì¬í•¨ ex) â€œë´‰ì¤€í˜¸, í•˜ì •ìš°â€
  - ì½¤ë§ˆë¥¼ í¬í•¨í•˜ì—¬ í•™ìŠµì„ ì§„í–‰í•  ê²½ìš° í•™ìŠµì˜ ì •í™•ë„(í¥í–‰ê³¼ì˜ ìƒê´€ê´€ê³„) ê°€ ë–¨ì–´ì§ˆ ìˆ˜ ìˆìŒ
  - ì½¤ë§ˆë¡œ êµ¬ë¶„ëœ ê°’ ì¤‘ ì²«ë²ˆì§¸ ê°’ë§Œ ì±„íƒí•˜ë„ë¡ ì „ì²˜ë¦¬ ì§„í–‰
        
    ```py
    df['directors'] = df['directors'].apply(lambda x: x.split(',')[0])
    ```
        
  - ë¬¸ìì—´ë¡œ ëœ ì»¬ëŸ¼(**ê°ë…, ì‘ê°€, ë°°ìš°, ì œì‘ì‚¬, ì¹´í…Œê³ ë¦¬**)ì„ **Label Encoding** ì§„í–‰
### ì˜ˆì¸¡ì„ ìœ„í•œ Profit, Hit ì»¬ëŸ¼ ìƒì„±
  - Profit : ìˆ˜ìµ / ì˜ˆì‚° * 100
  - Hit(í¥í–‰ì—¬ë¶€) : Profit â‰¥ 100 (True/False Boolean List)
### Target Feature
  - ìœ„ì—ì„œ ìƒì„±í•œ **Hit** ì»¬ëŸ¼

# 3. Using Model and Performances
### ëª¨ë¸ë³„ ì„±ëŠ¥
| ëª¨ë¸ | ê°œì„  ì „ ì •í™•ë„ | ê°œì„  í›„ ì •í™•ë„ | í¥í–‰(1) F1-score ê°œì„  |
|------|-------------|-------------|-----------|
| **LogisticRegression** | **72.29%** | **54.21%** | **0.00 â†’ 0.42 (ê°œì„ ë¨)** |
| **SVM(SVC)** | **73.27%** | - | - |
| **DecisionTreeClassifier** | **75%** | - | - |
| **KNeighborsClassifier** | **77.24%** | **77.94%** | - |
| **RandomForest** | **79%** | - | 0.52 |
| **XGBoost** | **80.37%** | **77.62%** | **0.59 â†’ 0.62 (ê°œì„ ë¨)** |
| **LGBMClassifier** | **81.91%** | **82.66%** | **0.54 â†’ 0.62 (ê°œì„ ë¨)** |
  - ì‚¬ìš©í•œ ë¶„ë¥˜ ëª¨ë¸ ì¤‘ LGBMClassifier ëª¨ë¸ì´ ê°€ì¥ ë†’ì€ ì„±ëŠ¥ì„ ë„ì¶œ
    - í•˜ì´í¼ íŒŒë¼ë©”í„° íŠœë‹ì„ í†µí•˜ì—¬ ì•½83%ì˜ ì •í™•ë„ ë‹¬ì„± (0.75%ì˜ ì„±ëŠ¥ í–¥ìƒ)
  - LGBMClassifierì˜ ì„±ëŠ¥ì´ ê°€ì¥ ë†’ì•˜ë˜ ì´ìœ 
    - ë°ì´í„°ê°€ **ë¹„ì„ í˜•ì  ê´€ê³„ë¥¼ í¬í•¨** â†’ íŠ¸ë¦¬ ê¸°ë°˜ ëª¨ë¸ì´ ìœ ë¦¬
    - LGBMì€ **ì›-í•« ì¸ì½”ë”© ì—†ì´ë„ ë²”ì£¼í˜• ë³€ìˆ˜ ì²˜ë¦¬ ê°€ëŠ¥**
- GridSearchCV ë°©ì‹ì„ í†µí•˜ì—¬ ìµœì ì˜ í•˜ì´í¼ íŒŒë¼ë©”í„° ë„ì¶œ
   ```python
   param_grid = {
    'num_leaves': [7, 15, 31, 63, 127],
    'learning_rate': [0.01, 0.05, 0.1],
    'n_estimators': [100, 200, 500],
    'max_depth': [3, 5, 7],
  }
   # Best parameters: {'learning_rate': 0.1, 'max_depth': 3, 'n_estimators': 500, 'num_leaves': 15}
   ```
## ì‹œê°í™” ë¶€ë¶„
  ### Feature ë³„ ì¤‘ìš”ë„ 
  ![output](https://github.com/user-attachments/assets/fda3bf24-5f89-4826-9751-6306a30cb6ce)
  ### í˜¼ë™í–‰ë ¬ê³¼ í‰ê°€ ì§€í‘œ
  ![cm](https://github.com/user-attachments/assets/47a644b0-624a-45ff-a2ec-3822313c35d3)
  ```
                precision    recall  f1-score   support

             0       0.84      0.93      0.89      1568
             1       0.75      0.53      0.62       572

      accuracy                           0.83      2140
     macro avg       0.80      0.73      0.75      2140
  weighted avg       0.82      0.83      0.82      2140
  ```
  ##### í‰ê°€ì§€í‘œ ë¶„ì„
  - 1 í´ë˜ìŠ¤ (í¥í–‰ ì„±ê³µ) ë¶€ë¶„ì—ì„œ Recall(ì¬í˜„ìœ¨)ì´ ë‚®ì•„ ë°ì´í„° ì¦ê°• í˜¹ì€ ê°€ì¤‘ì¹˜ ì¡°ì •ì„ ê³ ë ¤í•´ì•¼í•¨
    - Precision (ì •ë°€ë„): 0.75
      - ëª¨ë¸ì´ ì˜ˆì¸¡í•œ 1 í´ë˜ìŠ¤ ì¤‘ì—ì„œ 75%ê°€ ì‹¤ì œë¡œ 1 í´ë˜ìŠ¤ì„.
    - Recall (ì¬í˜„ìœ¨): 0.53
      - ì‹¤ì œ 1 í´ë˜ìŠ¤ ì¤‘ì—ì„œ 53%ë§Œ ëª¨ë¸ì´ 1ë¡œ ì •í™•íˆ ì˜ˆì¸¡í•¨.
    - F1-Score: 0.62
      - Precisionê³¼ Recallì˜ ì¡°í™” í‰ê· ìœ¼ë¡œ, 1 í´ë˜ìŠ¤ì˜ ì˜ˆì¸¡ ì„±ëŠ¥ì´ ë‹¤ì†Œ ë‚®ìŒì„ ë³´ì—¬ì¤Œ.
  ### ROC ì»¤ë¸Œ â†’ ì´ì§„ ë¶„ë¥˜ì˜ ì„±ëŠ¥ì„ ë‚˜íƒ€ë‚¸ ì§€í‘œ (True Positiveì™€ False Positiveì˜ ë¹„ìœ¨)
  ![roc](https://github.com/user-attachments/assets/2f69ec36-367c-4311-b719-a8f0bdeb3a29)
  - AUC ê°€ 1ì— ê°€ê¹Œìš¸ìˆ˜ë¡ ì¢‹ì€ ì„±ëŠ¥
  - 0.7 ì´ìƒì˜ ê²½ìš° ì“¸ë§Œí•œ ì„±ëŠ¥ â†’ 0.85

# 4. Predict Results (ì‹¤ì œ ì˜ˆì¸¡ ê²°ê³¼)
### ë°ì´í„° ì…‹ ì¤‘ ë¬´ì‘ìœ„ ë°ì´í„°ë¥¼ ê³¨ë¼ì„œ ì˜ˆì¸¡ê³¼ ì˜ˆì¸¡ í™•ë¥ ì„ í‘œì‹œ
```
--- Prediction Result ---
--------------------------------------------------
Title:  470. Hit Man
--------------------------------------------------
Data 1: Not Hit (4.72%)
Actual Value: Not Hit
--------------------------------------------------
Title:  183. A Hidden Life
--------------------------------------------------
Data 2: Not Hit (8.80%)
Actual Value: Not Hit
--------------------------------------------------
Title:  1. Avatar
--------------------------------------------------
Data 3: Hit (94.46%)
Actual Value: Hit
--------------------------------------------------
Title:  420. Appropriate Behavior
--------------------------------------------------
Data 4: Not Hit (8.00%)
Actual Value: Not Hit
--------------------------------------------------
Title:  388. Before the Sunset
--------------------------------------------------
Data 5: Not Hit (5.45%)
Actual Value: Not Hit

--- Prediction Result ---
--------------------------------------------------
Title:  56. Jupiter Ascending
--------------------------------------------------
Data 1: Hit (88.06%)
Actual Value: Hit
--------------------------------------------------
Title:  203. Frank and Ava
--------------------------------------------------
Data 2: Not Hit (18.20%)
Actual Value: Not Hit
--------------------------------------------------
Title:  527. Senior Year
--------------------------------------------------
Data 3: Not Hit (6.33%)
Actual Value: Not Hit
--------------------------------------------------
Title:  26. The Mummy: Tomb of the Dragon Emperor
--------------------------------------------------
Data 4: Hit (88.62%)
Actual Value: Hit
--------------------------------------------------
Title:  79. Bonhoeffer: Pastor. Spy. Assassin.
--------------------------------------------------
Data 5: Not Hit (2.97%)
Actual Value: Not Hit
```
# 5. Expectations (ê¸°ëŒ€ íš¨ê³¼)
  - ì œì‘ì‚¬ì—ê²Œ ì˜í™” ì œì‘ ê´€ë ¨ ê°€ì´ë“œ ì œê³µ
  - ì˜í™” ì œì‘ê°„ ì˜í™” í¥í–‰ ê°€ëŠ¥ì„±ì— ëŒ€í•œ ê·¼ê±° ìë£Œ
  - íˆ¬ììë“¤ì—ê²Œ ì„±ê³µë¥  ë†’ì€ ì˜í™”ì— íˆ¬ì ì „ëµ ì œê³µ
  - ë¦¬ì„œì¹˜ ì—…ì²´ì—ì„œ ìƒˆë¡œ ê°œë´‰í•œ ì˜í™”ì˜ í¥í–‰ ê°€ëŠ¥ì„±ì— ëŒ€í•œ ì§€í‘œ ì œê³µ
